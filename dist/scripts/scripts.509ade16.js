"use strict";$(document).ready(function(){langSwitch.initLang(),langSwitch.buttonClicked(),helpContact.showHideDropdown(),schoolInput.typeAhead(),schoolInput.formSubmit()});var langSwitch={toEn:function(){$(".zh").addClass("hidden"),$(".en").removeClass("hidden"),$(".en").removeClass("invisible"),$("title").text("Apartment Hunting"),$("#search-str").attr("placeholder","I will go to...")},toZh:function(){$(".en").addClass("hidden"),$(".zh").removeClass("hidden"),$(".zh").removeClass("invisible"),$("title").text("美国留学租房"),$("#search-str").attr("placeholder","输入学校查找附近住房")},initLang:function(){var a=localStorage.getItem("userLang");a||(a=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage),"en-US"===a||"en"===a?this.toEn():this.toZh()},buttonClicked:function(){$("#switch-zh").click(function(){localStorage.setItem("userLang","zh"),langSwitch.toZh()}),$("#switch-en").click(function(){localStorage.setItem("userLang","en"),langSwitch.toEn()})}},helpContact={showHideDropdown:function(){$(".help-contact").mouseenter(function(){$(".help-dropdown").addClass("show")}).mouseleave(function(){$(".help-dropdown").removeClass("show")})}},substringMatcher=function(a){return function(b,c){var d,e;d=[],e=new RegExp(b,"i"),$.each(a,function(a,b){e.test(b)&&d.push({value:b})}),c(d)}},universityMap={"Columbia University":"columbia","New York University":"nyu","Stony Brook University":"stony","City University of New York":"cuny"},appHost="http://app.roomhunter.us";"roomhunter.us"!==location.hostname&&"www.roomhunter.us"!==location.hostname&&(appHost="http://"+location.hostname+":2001");var schoolInput={formSubmit:function(){$("#query-form").submit(function(a){var b=$("#search-str").val(),c=universityMap[b];return c?(a.preventDefault(),void(window.location=appHost+"/#/li/"+c)):!1}),$("a.popular-university-container").click(function(a){a.preventDefault(),window.location=appHost+$(this).attr("href")})},typeAhead:function(){var a=$("#search-str").typeahead({hint:!0,highlight:!0,minLength:1},{name:"schools",displayKey:"value",source:substringMatcher(Object.keys(universityMap)),templates:{empty:['<div class="tt-empty-message text-muted">','<i class="fa fa-frown-o"></i>',"unable to find any schools matching current query","</div>"].join("\n")}});a.on("typeahead:selected",function(){var a=$("#search-str").val(),b=universityMap[a];return b?void(window.location=appHost+"/#/li/"+b):!1}).on("typeahead:cursorchanged",function(){console.log($("#search-str").val()),console.log("autocomplete");var a=$("#search-btn");a.removeClass("disabled")}).on("typeahead:closed",function(){var a=$("#search-str").val(),b=$("#search-btn"),c=universityMap[a];c?(console.log("valid"),b.removeClass("disabled")):(console.log("invalid"),b.addClass("disabled"))}),a.keyup(function(){var a=$("#search-str").val(),b=$("#search-btn"),c=universityMap[a];c?(console.log("valid"),b.removeClass("disabled")):(console.log("invalid"),b.addClass("disabled"))})}};